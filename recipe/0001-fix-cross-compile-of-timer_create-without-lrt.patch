From dac8649d52673f125902e017f543efd9add34741 Mon Sep 17 00:00:00 2001
From: Brandon Maier <brandon.maier@gmail.com>
Date: Tue, 17 Dec 2024 12:10:22 -0600
Subject: [PATCH] fix cross-compile of timer_create without -lrt

---
 src/auto/configure | 3 +--
 src/configure.ac   | 3 +--
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/src/auto/configure b/src/auto/configure
index 062119e77..2c9d9e8f2 100755
--- a/src/auto/configure
+++ b/src/auto/configure
@@ -14234,7 +14234,7 @@ fi
 if test "x$vim_cv_timer_create" = "xyes" ||
    test "x$vim_cv_timer_create_with_lrt" = "xyes"; then
   save_LIBS="$LIBS"
-  if test "x$vim_cv_timer_create_works" = "xyes" ; then
+  if test "x$vim_cv_timer_create_with_lrt" = "xyes" ; then
     LIBS="$LIBS -lrt"
   fi
 
@@ -14297,7 +14297,6 @@ printf "%s\n" "$vim_cv_timer_create_works" >&6; }
   if test "x$vim_cv_timer_create_works" = "xyes" ; then
     printf "%s\n" "#define HAVE_TIMER_CREATE 1" >>confdefs.h
 
-    LIBS="$LIBS -lrt"
   else
     LIBS="$save_LIBS"
   fi
diff --git a/src/configure.ac b/src/configure.ac
index 56895f66a..2943ec553 100644
--- a/src/configure.ac
+++ b/src/configure.ac
@@ -3908,7 +3908,7 @@ dnl works, on Solaris timer_create() exists but fails at runtime.
 if test "x$vim_cv_timer_create" = "xyes" ||
    test "x$vim_cv_timer_create_with_lrt" = "xyes"; then
   save_LIBS="$LIBS"
-  if test "x$vim_cv_timer_create_works" = "xyes" ; then
+  if test "x$vim_cv_timer_create_with_lrt" = "xyes" ; then
     LIBS="$LIBS -lrt"
   fi
 
@@ -3939,7 +3939,6 @@ if test "x$vim_cv_timer_create" = "xyes" ||
 
   if test "x$vim_cv_timer_create_works" = "xyes" ; then
     AC_DEFINE(HAVE_TIMER_CREATE)
-    LIBS="$LIBS -lrt"
   else
     LIBS="$save_LIBS"
   fi
-- 
2.47.1

